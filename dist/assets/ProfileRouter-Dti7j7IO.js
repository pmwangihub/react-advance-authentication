import{r as d,u as L,x as J,y as V,z as Q,j as e,c as R,D as X,E as W,G as Z,B as N,P as g,h as ee,o as c,a as j,N as A,L as T,C as se,O as ae,e as S,H as te,d as E,I as ne,J as I,K as le,M as re,f as y,Q as O,S as oe,t as ie,T as ce,g as de,v as ue,w as p,i as P,U as $}from"./index-BGvQeito.js";import{R as F,C as m,S as me,A as D}from"./Spinner-D6IqYoek.js";const _=d.forwardRef(({bsPrefix:s,active:a,disabled:t,eventKey:n,className:r,variant:i,action:l,as:u,...o},h)=>{s=L(s,"list-group-item");const[x,M]=J({key:V(n,o.href),active:a,...o}),q=Q(v=>{if(t){v.preventDefault(),v.stopPropagation();return}x.onClick(v)});t&&o.tabIndex===void 0&&(o.tabIndex=-1,o["aria-disabled"]=!0);const H=u||(l?o.href?"a":"button":"div");return e.jsx(H,{ref:h,...o,...x,onClick:q,className:R(r,s,M.isActive&&"active",t&&"disabled",i&&`${s}-${i}`,l&&`${s}-action`)})});_.displayName="ListGroupItem";const w=d.forwardRef((s,a)=>{const{className:t,bsPrefix:n,variant:r,horizontal:i,numbered:l,as:u="div",...o}=X(s,{activeKey:"onSelect"}),h=L(n,"list-group");let x;return i&&(x=i===!0?"horizontal":`horizontal-${i}`),e.jsx(W,{ref:a,...o,as:u,className:R(t,h,r&&`${h}-${r}`,x&&`${h}-${x}`,l&&`${h}-numbered`)})});w.displayName="ListGroup";const f=Object.assign(w,{Item:_});function C({animation:s,bg:a,bsPrefix:t,size:n,...r}){t=L(t,"placeholder");const[{className:i,...l}]=Z(r);return{...l,className:R(i,s?`${t}-${s}`:t,n&&`${t}-${n}`,a&&`bg-${a}`)}}const U=d.forwardRef((s,a)=>{const t=C(s);return e.jsx(N,{...t,ref:a,disabled:!0,tabIndex:-1})});U.displayName="PlaceholderButton";const B=d.forwardRef(({as:s="span",...a},t)=>{const n=C(a);return e.jsx(s,{...n,ref:t})});B.displayName="Placeholder";const b=Object.assign(B,{Button:U}),he=()=>{var i;const s=ee(),a=d.useMemo(()=>[{eventKey:"dash",route:`${c.PROFILE}${c.DASHBOARD}`,icon:"bx bx-food-menu",label:"Dashboard"},{eventKey:"info",route:`${c.PROFILE}${c.PROFILE_INFO}`,icon:"bx bx-user-circle",label:"Your info"},{eventKey:"settings",route:`${c.PROFILE}${c.PROFILE_SETTINGS}`,icon:"bx bx-cog",label:"Settings"},{eventKey:"security",route:`${c.PROFILE}${c.PROFILE_SECURITY}`,icon:"bx bx-shield",label:"Security"},{eventKey:"secured",route:`${c.PROFILE}${c.PROFILE_SECURED_INFO}`,icon:"bx bxs-data",label:"Secured info"}],[]),[t,n]=d.useState(((i=a.find(l=>s.pathname===l.route))==null?void 0:i.eventKey)||"dash");d.useEffect(()=>{var u;const l=(u=a.find(o=>s.pathname===o.route))==null?void 0:u.eventKey;l&&n(l)},[s.pathname,a]);const r=l=>{n(l)};return e.jsx(j,{md:3,lg:2,className:"sidebar p-0",children:e.jsx("div",{className:"offcanvas-md offcanvas-end",tabIndex:"-1",id:"profileSideBar",children:e.jsx("div",{className:"offcanvas-body d-md-flex flex-column p-0 pt-lg-3 overflow-y-auto",children:e.jsx(A,{className:"flex-column",activeKey:t,onSelect:r,children:a.map(({eventKey:l,route:u,icon:o,label:h})=>e.jsxs(k,{eventKey:l,route:u,isActive:t===l,children:[e.jsx("i",{className:`${o} me-2 fs-5 text-secondary`}),h]},l))})})})})},k=({route:s,children:a,eventKey:t,isActive:n,style:r=""})=>{const i=`d-flex small align-items-center ${r} ${n?"active":""}`;return e.jsx(A.Link,{as:T,to:s,eventKey:t,className:i,children:a})};k.propTypes={route:g.string.isRequired,style:g.string,eventKey:g.string,children:g.node,isActive:g.bool};function z(){return e.jsx(se,{fluid:!0,className:"mt-4",children:e.jsxs(F,{children:[e.jsx(he,{}),e.jsx(j,{md:9,lg:8,className:"mx-auto",children:e.jsx(ae,{})})]})})}z.propTypes={};const G=()=>{const s=S(),a=()=>{s(te())};return e.jsxs(m.Body,{children:[e.jsx("h5",{className:"card-title pb-0 fs-4",children:"Confirm you want to sign out"}),e.jsx("p",{className:"small",children:"Choose one of the actions below."}),e.jsx(N,{variant:"danger",size:"sm",className:"px-5",onClick:a,children:"Sign out"})]})};G.propTypes={};const K=()=>{const{authData:s,authLoader:a}=E(r=>r.AuthLoginReducer),t=a?"Fetching account info ...":"Personal information",n=a?e.jsx(pe,{}):fe;return e.jsxs(m,{border:"light",className:"shadow",children:[e.jsx(m.Body,{className:"pb-0",children:e.jsx(m.Title,{children:t})}),e.jsx(m.Body,{className:"px-0",children:e.jsxs(f,{variant:"flush",children:[e.jsx(f.Item,{children:n}),!a&&s&&e.jsxs(e.Fragment,{children:[e.jsxs(f.Item,{children:[e.jsx("span",{className:"me-3",children:"Email"}),e.jsx("span",{className:"fw-bold",children:s.user.email})]}),e.jsxs(f.Item,{children:[e.jsx("span",{className:"me-3",children:"Full names"}),s.user.full_name?e.jsx("span",{className:"fw-bold",children:s.user.full_name}):e.jsx(N,{variant:"warning",size:"sm",children:"Update info"})]}),e.jsxs(f.Item,{children:[e.jsx("span",{className:"me-3",children:"Initials"}),s.user.initials?e.jsx("span",{className:"fw-bold",children:s.user.initials}):e.jsx(N,{variant:"warning",size:"sm",children:"Update info"})]}),e.jsxs(f.Item,{children:[e.jsx("span",{className:"me-3",children:"Account Status"}),e.jsxs("span",{className:"fw-bold",children:[" ",s.user.is_active?"Active":"Inactive"]})]}),e.jsxs(f.Item,{children:[e.jsx("span",{className:"me-3",children:"Join Date"}),e.jsxs("span",{className:"fw-bold",children:[" ",ne.PlainDate(s.user.timestamp)]})]}),e.jsx(f.Item,{as:T,to:`${c.PROFILE}${c.PROFILE_SETTINGS}`,action:!0,className:`${xe} py-3`,children:"Manage your data"})]})]})})]})},xe="link-primary link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover",fe="See the data in your Django Account and personalize your Account experience.",pe=()=>e.jsx(b,{as:m.Title,animation:"glow",children:e.jsxs(b,{as:m.Text,animation:"glow",children:[e.jsx(b,{xs:7})," ",e.jsx(b,{xs:6})]})}),je=()=>e.jsx(K,{}),Y=()=>{const[s,a]=d.useState(!1),t=S(),n=()=>{a(!0),le().then(r=>{a(!1)}).catch(r=>{a(!1)}),t(re())};return e.jsxs(m.Body,{children:[e.jsx("h5",{className:"card-title pb-0 fs-4",children:"Your security settings."}),e.jsx("p",{className:"small",children:"Choose one of the actions below."}),e.jsxs(I,{children:[e.jsx(I.Toggle,{variant:"danger",id:"deleteAccountBtn",className:"btn-sm px-4",children:s?"Deleting account...":"Delete Account"}),e.jsx(I.Menu,{children:e.jsx(I.Item,{className:"text-center small",onClick:n,children:"Yes, delete this account"})})]})]})};Y.propTypes={};const Ne=()=>{const{authData:s}=E(n=>n.AuthLoginReducer),a=S(),t=async n=>{n.preventDefault();const r=new FormData(n.target),i={full_name:r.get("full_name"),initials:r.get("initials")};try{const u=(await oe(i)).data.user,o=localStorage.getItem("authData");if(o){const x={...JSON.parse(o),user:u};localStorage.setItem("authData",JSON.stringify(x)),a(ie(x))}}catch{}};return e.jsx(m,{className:"border-0 shadow mb-3 w-100",children:e.jsxs(m.Body,{children:[e.jsx(m.Title,{className:"mb-4",children:"Update your profile info"}),e.jsxs(y,{onSubmit:t,children:[e.jsx(F,{className:"mb-3",children:e.jsxs(j,{children:[e.jsx(j,{md:6,children:e.jsx("div",{className:"mb-3",children:e.jsx(y.Group,{controlId:"formInitials",children:e.jsx(y.Control,{className:"fw-bold",plaintext:!0,readOnly:!0,defaultValue:s?s.user.email:"No email"})})})}),e.jsx(j,{md:6,children:e.jsx("div",{className:"mb-3",children:e.jsx(O,{controlId:"full_name",label:"Full name",children:e.jsx(y.Control,{size:"sm",type:"text",name:"full_name",placeholder:"Enter your full name",defaultValue:s?s.user.full_name:"",required:!0})})})}),e.jsx(j,{md:6,children:e.jsx("div",{className:"mb-3",children:e.jsx(O,{controlId:"initials",label:"Your initials",children:e.jsx(y.Control,{size:"sm",type:"text",name:"initials",placeholder:"Enter your initials",defaultValue:s?s.user.initials:"",required:!0})})})})]})}),e.jsx(N,{variant:"primary",size:"sm",type:"submit",className:"px-4",children:"Update"})]})]})})},ge=()=>{const[s,a]=d.useState(!1),[t,n]=d.useState(null),[r,i]=d.useState(null),l=()=>{a(!0),i(null),ce().then(o=>{n(o.data),i(null)}).catch(o=>{i(o.response.data),n(null)}).finally(()=>{a(!1)})};d.useEffect(()=>{l()},[]);const u=()=>{l()};return e.jsxs(m.Body,{children:[e.jsx("h5",{className:"card-title pb-0 fs-4",children:"This is a secured page."}),e.jsx("p",{className:"small",children:"This page only receives secured information from the server directly."}),e.jsx(N,{variant:"primary",size:"sm",onClick:u,children:s?"Loading ...":"Reload info"}),e.jsxs(j,{className:"py-4",lg:"8",children:[s&&e.jsx(me,{animation:"border",variant:"primary"}),t&&e.jsx(D,{info:t,variant:"info",dismissible:!1}),r&&e.jsx(D,{info:r,variant:"warning"})]})]})},ye=`${P.auth}${P.login}`,Ie=`${$.profile}${$.dash}`,Le=()=>{const{authData:s,authLoader:a}=E(n=>n.AuthLoginReducer),t=de();return d.useEffect(()=>{!s&&!a&&(()=>{if(!(s&&!a))return t(ye,{state:{next_url:Ie}})})()},[s,a,t]),e.jsx(ue,{children:e.jsxs(p,{element:e.jsx(z,{}),children:[e.jsx(p,{path:c.DASHBOARD,element:e.jsx(K,{})}),e.jsx(p,{path:c.LOGOUT_CONFIRM,element:e.jsx(G,{})}),e.jsx(p,{path:c.PROFILE_INFO,element:e.jsx(je,{})}),e.jsx(p,{path:c.PROFILE_SECURITY,element:e.jsx(Y,{})}),e.jsx(p,{path:c.PROFILE_SETTINGS,element:e.jsx(Ne,{})}),e.jsx(p,{path:c.PROFILE_SECURED_INFO,element:e.jsx(ge,{})})]})})};export{Le as default};
